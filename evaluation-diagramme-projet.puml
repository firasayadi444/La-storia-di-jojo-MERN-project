@startuml Ã‰valuation Diagramme vs Projet RÃ©el

title Ã‰valuation de CohÃ©rence - Diagramme UML vs ImplÃ©mentation

!define COHERENT class
!define INCOHERENT class
!define MANQUANT class
!define CORRECTION class

' Classes cohÃ©rentes avec l'implÃ©mentation
COHERENT User {
  âœ… _id: ObjectId
  âœ… name: String
  âœ… email: String
  âœ… password: String
  âœ… role: String (user|admin|delivery)
  âœ… phone: String
  âœ… isAvailable: Boolean
  âœ… address: String
  âœ… mustChangePassword: Boolean
  âœ… currentLocation: Array[Number]
  --
  âŒ MANQUANT: status (pending|active|rejected)
  âŒ MANQUANT: vehicleType, vehiclePhoto, facePhoto, cinPhoto
}

COHERENT Order {
  âœ… _id: ObjectId
  âœ… user: ObjectId -> User
  âœ… items: Array[OrderItem]
  âœ… totalAmount: Number
  âœ… status: String (pending|confirmed|preparing|ready|out_for_delivery|delivered|cancelled)
  âœ… deliveryAddress: String
  âœ… deliveryMan: ObjectId -> User
  âœ… deliveryRating: Number
  âœ… foodRating: Number
  âœ… feedbackComment: String
  âœ… payment: ObjectId -> Payment
  --
  âŒ MANQUANT: customerLocation (GeoLocation)
  âŒ MANQUANT: estimatedDeliveryTime, actualDeliveryTime
  âŒ MANQUANT: deliveryNotes, assignedAt, cancelledAt
}

COHERENT Payment {
  âœ… _id: ObjectId
  âœ… userId: ObjectId -> User
  âœ… orderId: ObjectId -> Order
  âœ… amount: Number
  âœ… paymentMethod: String (card|cash)
  âœ… paymentStatus: String (pending|paid|failed|refunded)
  âœ… stripePaymentId: String
  --
  âŒ MANQUANT: stripeChargeId, stripePaymentIntentId
  âŒ MANQUANT: paidAt, refundedAt, refundId, refundReason
}

COHERENT Food {
  âœ… _id: ObjectId
  âœ… name: String
  âœ… category: String
  âœ… price: Number
  âœ… description: String
  âœ… image: String
  âœ… available: Boolean
}

' Classes avec incohÃ©rences
INCOHERENT DelevryHistory {
  âŒ NOM: "DelevryHistory" (devrait Ãªtre "DeliveryHistory")
  âœ… deliveryManId: ObjectId -> User
  âœ… customerId: ObjectId -> User
  âœ… orderId: ObjectId -> Order
  âœ… deliveryRating: Number
  âœ… assignedAt, pickedUpAt, deliveredAt: Date
  --
  âŒ MANQUANT: pickupLocation, deliveryLocation (GeoLocation)
  âŒ MANQUANT: routePoints: Array[RoutePoint]
  âŒ MANQUANT: totalDistance, totalTime, averageSpeed
  âŒ MANQUANT: statusHistory: Array[StatusEntry]
  âŒ MANQUANT: deliveryNotes, customerFeedback
  âŒ MANQUANT: completedAt: Date
}

' Classes manquantes dans le diagramme
MANQUANT OrderItem {
  +food: ObjectId -> Food
  +quantity: Number
  +price: Number
}

MANQUANT GeoLocation {
  +latitude: Number
  +longitude: Number
  +accuracy: Number
  +timestamp: Date
}

MANQUANT RoutePoint {
  +latitude: Number
  +longitude: Number
  +timestamp: Date
  +accuracy: Number
  +speed: Number
  +heading: Number
}

MANQUANT StatusEntry {
  +status: String (assigned|picked_up|in_transit|delivered|failed)
  +timestamp: Date
  +location: GeoLocation
  +notes: String
}

' Ã‰numÃ©rations - Ã‰valuation
note as N1
  **Ã‰VALUATION DES Ã‰NUMÃ‰RATIONS:**
  
  âœ… **UserRole**: CohÃ©rent
  - Diagramme: Admin, Costumer, DelevryMen
  - Code: "user", "admin", "delivery"
  - CORRECTION: "Costumer" â†’ "Customer", "DelevryMen" â†’ "Delivery"
  
  âœ… **OrderStatus**: CohÃ©rent
  - Diagramme: Pending, confirmed, preparing, ready, out_for_delevry, delivred, cancelled
  - Code: 'pending', 'confirmed', 'preparing', 'ready', 'out_for_delivery', 'delivered', 'cancelled'
  - CORRECTION: "out_for_delevry" â†’ "out_for_delivery", "delivred" â†’ "delivered"
  
  âœ… **PaymentMethod**: CohÃ©rent
  - Diagramme: cash, cart
  - Code: 'card', 'cash'
  - CORRECTION: "cart" â†’ "card"
  
  âœ… **PaymentStatus**: CohÃ©rent
  - Diagramme: pending, paid, failed
  - Code: 'pending', 'paid', 'failed', 'refunded'
  - MANQUANT: "refunded" dans le diagramme
end note

' Relations - Ã‰valuation
note as N2
  **Ã‰VALUATION DES RELATIONS:**
  
  âœ… **User â†’ Order (1:many)**: CohÃ©rent
  âœ… **User â†’ Payment (1:many)**: CohÃ©rent
  âœ… **User â†’ DeliveryHistory (1:many)**: CohÃ©rent
  âœ… **Order â†’ Payment (1:1)**: CohÃ©rent
  âœ… **Order â†’ DeliveryHistory (1:1)**: CohÃ©rent
  âœ… **Order â†’ FoodItem (1:many)**: CohÃ©rent
  âœ… **FoodItem â†’ Food (many:1)**: CohÃ©rent
  
  âŒ **PROBLÃˆME MAJEUR**: 
  - Diagramme: DeliveryHistory (0..*) â†’ Order (0..1)
  - Code: DeliveryHistory (1) â†’ Order (1) - Relation 1:1
  - CORRECTION: DeliveryHistory (1) â†’ Order (1)
end note

' Score global
note as N3
  **SCORE GLOBAL DE COHÃ‰RENCE:**
  
  ğŸŸ¢ **COHÃ‰RENT (70%)**:
  - Structure gÃ©nÃ©rale correcte
  - Relations principales respectÃ©es
  - EntitÃ©s principales prÃ©sentes
  
  ğŸŸ¡ **AMÃ‰LIORATIONS NÃ‰CESSAIRES (20%)**:
  - Corrections orthographiques
  - Ajout d'attributs manquants
  - Correction des cardinalitÃ©s
  
  ğŸ”´ **PROBLÃˆMES MAJEURS (10%)**:
  - Nom de classe incorrect
  - Attributs critiques manquants
  - CardinalitÃ©s incorrectes
end note

@enduml
